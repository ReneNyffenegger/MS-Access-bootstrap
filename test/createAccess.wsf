<!--

   Create access application from commandline with VBScript:

       cscript createAccess.wsf

-->
<job id="IsThisIdRequired">

   <script language="VBScript" src="../accessBootstrap.vbs" />

   <script language="VBScript">

      option explicit

      dim wshShell
      set wshShell = createObject("WScript.Shell")

      dim projectRootDir
          projectRootDir = wshShell.CurrentDirectory & "\" ' "p:\ath\to\project\root\"

      wscript.echo("projectRootDir = " & projectRootDir)

      call createDB(projectRootDir & "created.accdb")

    '
    ' Add (TypeLib) References
    '          '          '
      call addReference("{420B2830-E718-11CF-893D-00A0C9054228}", 1, 0) ' Microsoft Scripting Runtime

    '
    ' Insert a module. The 3rd parameter (1) indicates a »normal« module (vbext_ct_StdModule)
    ' rather than a class module (vbext_ct_ClassModule)
    '
      call insertModule(projectRootDir & "init.bas", "init", 1)

    '
    ' Call a function/sub that is defined in the inserted init.bas:
    '
    ' If calling a function, the following run cannot use paranthesis
    '   (Error message: Microsoft VBScript compilation error: Cannot use parentheses when calling a Sub )
    '
      acc.run "createApplication", projectRootDir


      wscript.echo("The end")

   </script>

</job>
